#include <stdio.h>
#include <string.h>

// Function to get the Unicode code point of a UTF-8 character
int getCodePoint(const char *str, int index) {
    int i = 0;
    int codePoint = 0;
    int bytes = 0;

    while (str[i] != '\0') {
        unsigned char c = str[i];

        if ((c & 0x80) == 0) {          // 1-byte ASCII
            codePoint = c;
            bytes = 1;
        } else if ((c & 0xE0) == 0xC0) { // 2-byte UTF-8
            codePoint = ((c & 0x1F) << 6) | (str[i+1] & 0x3F);
            bytes = 2;
        } else if ((c & 0xF0) == 0xE0) { // 3-byte UTF-8
            codePoint = ((c & 0x0F) << 12) | ((str[i+1] & 0x3F) << 6) | (str[i+2] & 0x3F);
            bytes = 3;
        } else if ((c & 0xF8) == 0xF0) { // 4-byte UTF-8
            codePoint = ((c & 0x07) << 18) | ((str[i+1] & 0x3F) << 12) | ((str[i+2] & 0x3F) << 6) | (str[i+3] & 0x3F);
            bytes = 4;
        } else {
            return -1; // Invalid UTF-8
        }

        if (index == 0) {
            return codePoint;
        }

        i += bytes;
        index--;
    }

    return -1; // Index out of bounds
}

int main() {
    char str[256];
    int index;

    printf("Enter a string: ");
    fgets(str, sizeof(str), stdin);

    // Remove newline if present
    str[strcspn(str, "\n")] = 0;

    printf("Enter the index of the character: ");
    scanf("%d", &index);

    int codePoint = getCodePoint(str, index);
    if (codePoint != -1) {
        printf("The Unicode code point at index %d is: U+%X\n", index, codePoint);
    } else {
        printf("Invalid index or character.\n");
    }

    return 0;
}
